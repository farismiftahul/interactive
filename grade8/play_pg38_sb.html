<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modals Quiz — 4 Teams Game</title>
  <style>
    :root{--accent:#0b66a3;--correct:#0a662a;--wrong:#a10b0b}
    body{font-family:Arial,Helvetica,sans-serif;max-width:1100px;margin:20px auto;padding:18px;color:#222}
    h1{font-size:20px;margin:6px 0 12px}
    .layout{display:grid;grid-template-columns:320px 1fr;gap:18px}
    .card{border:1px solid #ddd;padding:14px;border-radius:8px;background:#fbfbfc}
    .teams{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .team{padding:8px;border-radius:6px;background:#fff;border:1px solid #ccc}
    .team.active{box-shadow:0 0 0 3px rgba(11,102,163,0.12);border-color:var(--accent)}
    .team input{width:100%;font-weight:700;border:0;background:transparent}
    .score{font-size:18px;font-weight:700;color:var(--correct)}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .question{font-size:18px;margin:8px 0}
    .choices{display:flex;flex-direction:column;gap:8px}
    .choice{padding:10px;border-radius:6px;border:1px solid #ccc;background:#fff;cursor:pointer}
    .choice.disabled{opacity:0.6;cursor:not-allowed}
    .choice.correct{border-color:var(--correct);background:#e6f6ea}
    .choice.wrong{border-color:var(--wrong);background:#fdecea}
    button{padding:8px 12px;border-radius:6px;border:1px solid #888;background:#fff;cursor:pointer}
    button:disabled{opacity:0.5;cursor:not-allowed}
    .small{font-size:13px;color:#666}
    .progress{height:10px;background:#eee;border-radius:6px;overflow:hidden;margin-top:10px}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,#cfe8ff,#a6d0ff);width:0%}
    .explain{margin-top:10px;padding:10px;border-radius:6px;background:#fff;border:1px solid #eee}
    .settings{display:flex;gap:8px;align-items:center;margin-bottom:8px}
    pre{white-space:pre-wrap}
  </style>
</head>
<body>
  <h1>Modals of Permission & Request — 4 Teams Game</h1>
  <div class="layout">

    <div class="card">
      <div class="settings">
        <label class="small">Team names:</label>
        <input id="team0Name" value="Team A" />
        <input id="team1Name" value="Team B" />
        <input id="team2Name" value="Team C" />
        <input id="team3Name" value="Team D" />
      </div>

      <div class="teams" id="teamsContainer">
        <div class="team" data-index="0"><div><input id="t0" value="Team A" /></div><div class="small">Score: <span id="s0" class="score">0</span></div></div>
        <div class="team" data-index="1"><div><input id="t1" value="Team B" /></div><div class="small">Score: <span id="s1" class="score">0</span></div></div>
        <div class="team" data-index="2"><div><input id="t2" value="Team C" /></div><div class="small">Score: <span id="s2" class="score">0</span></div></div>
        <div class="team" data-index="3"><div><input id="t3" value="Team D" /></div><div class="small">Score: <span id="s3" class="score">0</span></div></div>
      </div>

      <div style="margin-top:10px" class="small">Active team: <strong id="activeName">Team A</strong></div>
      <div class="controls">
        <button id="startBtn">Start Game</button>
        <button id="nextBtn" disabled>Next Question (rotate)</button>
        <button id="correctBtn" disabled>Correct (+10)</button>
        <button id="wrongBtn" disabled>Incorrect</button>
        <button id="passBtn" disabled>Pass</button>
        <button id="revealBtn" disabled>Reveal Answer</button>
        <button id="resetBtn">Reset Game</button>
      </div>

      <div class="small" style="margin-top:8px">Use the inputs above to change team names. Click <em>Correct</em> to add points to the active team, or <em>Incorrect</em> if they miss. <strong>Next Question</strong> rotates to the next team.</div>
    </div>

    <div class="card">
      <div class="small">Questions remaining: <span id="remaining">24</span></div>
      <div class="progress"><i id="bar"></i></div>

      <div class="question" id="question">Click Start Game to begin.</div>

      <div class="choices" id="choices"></div>

      <div class="explain" id="explain" style="display:none"></div>

      <div id="usedArea" class="small" style="margin-top:8px"></div>
    </div>
  </div>

  <script>
    // question bank (same 24 items from previous file)
    const bank = [
      {q: 'Which modal is most appropriate to ask for formal permission?','choices':['Can I leave early?','Could I leave early?','May I leave early?','Will I leave early?'],'correct':2,'ex':'"May" is the most formal way to ask for permission.'},
      {q:'Which sentence shows asking permission politely using "could"?','choices':['Could I turn on the TV?','Could you turn on the TV?','Can I turn on the TV?','May I turn on the TV?'],'correct':0,'ex':'"Could I..." is a polite way to ask for permission for yourself.'},
      {q:'You want someone to do something now in an informal situation. Which modal fits?','choices':['Could you please close the window?','Will you close the window?','Would you mind closing the window?','Could I close the window?'],'correct':1,'ex':'"Will you..." or "Can you..." are used in less formal situations to make requests.'},
      {q:'Choose the most polite formal request:','choices':['Can you pass the salt?','Could you pass the salt?','Will you pass the salt?','Can I pass the salt?'],'correct':1,'ex':'"Could" is more formal and polite when making requests.'},
      {q:'Which sentence uses "would you mind" correctly?','choices':['Would you mind closing the window?','Would you mind to close the window?','Would you mind if I closes the window?','Would you mind I closed the window?'],'correct':0,'ex':'"Would you mind + Ving" is correct: "Would you mind closing the window?"'},
      {q:'Which option places "please" to be polite with a modal?','choices':['Please could you open the door?','Could you please open the door?','Could please you open the door?','Please you could open the door?'],'correct':1,'ex':'Place "please" after the subject or at the end: "Could you please..."'},
      {q:'Which sentence is a request using "can" (informal)?','choices':['Can I borrow your book, please?','Can you borrow my book?','Can you borrow your book?','Can I borrow you book?'],'correct':0,'ex':'"Can I borrow your book, please?" uses "can" to ask permission.'},
      {q:'For a polite refusal request, which modal would you choose?','choices':['Can you help me?','May you help me?','Would you mind helping me?','Could you help me?'],'correct':2,'ex':'"Would you mind..." is a polite phrasing for requests; often used for polite preference.'},
      {q:'Which is correct for asking permission to ask a question in a classroom?','choices':['Can I ask a question, please?','Could I ask a question, please?','May I ask a question, please?','All are possible'],'correct':3,'ex':'All three are possible; "may" is most formal, "could" is polite, "can" is common.'},
      {q:'Which sentence uses "would" for a polite request to a person?','choices':['Would you read it aloud?','Would you please to read it?','Would you to read it?','Would you read it? please'],'correct':0,'ex':'"Would you read it aloud?" uses "would" in a polite request.'},
      {q:'Which modal is NOT used to give permission?','choices':['Can','May','Could','Would you mind'],'correct':3,'ex':'"Would you mind" asks permission, but it\'s not used to give permission.'},
      {q:'Which sentence correctly asks someone to do something politely using "could"?','choices':['Could you turn down the TV, please?','Could you please to turn down the TV?','Could you please turn down the TV?','Could you the TV please turn down?'],'correct':2,'ex':'"Could you please turn down the TV?" is grammatically correct.'},
      {q:'Which is the best option to ask permission to see a ticket formally?','choices':['May I see your ticket, please?','Can I see your ticket, please?','Could you see my ticket?','Will you see my ticket?'],'correct':0,'ex':'"May I..." is the most formal way to ask permission.'},
      {q:'Which structure is used for a polite offer to ask permission for yourself?','choices':['Would you mind if I + V2','Would you mind + Ving','Could I + V','May you + V'],'correct':0,'ex':'"Would you mind if I + V2" asks politely for permission to do something yourself.'},
      {q:'Which sentence correctly asks someone politely to be quieter?','choices':['Would you mind being more quiet?','Would you mind to be more quiet?','Could you mind being more quiet?','Can you mind being more quiet?'],'correct':0,'ex':'"Would you mind being more quiet?" is correct (would you mind + Ving).'},
      {q:'Which sentence is a less formal request using "can"?','choices':['Can you lend me $5, please?','Could you lend me $5, please?','Would you mind lending me $5?','May you lend me $5?'],'correct':0,'ex':'"Can" is used in less formal situations to make requests.'},
      {q:'Choose the most natural polite question to offer help:','choices':['Can I help you?','Would I help you?','Could I helped you?','May me help you?'],'correct':0,'ex':'"Can I help you?" is natural and common for offers of help.'},
      {q:'Which sentence shows asking permission to switch on TV politely?','choices':['Could I turn on the TV?','Could you turn on the TV?','Can I turn on the TV?','May I turned on the TV?'],'correct':0,'ex':'"Could I turn on the TV?" is a polite request for permission.'},
      {q:'Which modal pair is used in more formal request situations?','choices':['can & will','could & would','can & may','will & may'],'correct':1,'ex':'"Could" and "would" are used in more formal situations to make requests.'},
      {q:'Which sentence is correct with "with please" placement?','choices':['Would you please turn down the TV?','Please would you turn down the TV?','Would you turn down please the TV?','Would please you turn down the TV?'],'correct':0,'ex':'"Would you please ..." is correct; please can be after the subject.'},
      {q:'Which modal is most polite for asking permission to make a change?','choices':['Can','Could','May','Will'],'correct':2,'ex':'"May" is the most formal/polite for permission.'},
      {q:'Which sentence correctly uses "could" to make a request to another person?','choices':['Could you pass me the book?','Could I pass you the book?','Can you pass me the book?','May I pass you the book?'],'correct':0,'ex':'"Could you pass me the book?" uses "could" to request something from someone.'},
      {q:'Which structure is used to ask politeness about someone else doing something?','choices':['Would you mind + Ving','Could I + V','May I + V','Can I + V'],'correct':0,'ex':'"Would you mind + Ving" makes very polite requests about someone else doing something.'}
    ];

    // game state for 4 teams
    let remainingIdx = [];
    let asked = [];
    let current = null; // index in bank
    let currentTeam = 0; // 0..3
    let scores = [0,0,0,0];

    // DOM refs
    const remainingEl = document.getElementById('remaining');
    const bar = document.getElementById('bar');
    const questionEl = document.getElementById('question');
    const choicesEl = document.getElementById('choices');
    const explainEl = document.getElementById('explain');
    const startBtn = document.getElementById('startBtn');
    const nextBtn = document.getElementById('nextBtn');
    const correctBtn = document.getElementById('correctBtn');
    const wrongBtn = document.getElementById('wrongBtn');
    const passBtn = document.getElementById('passBtn');
    const revealBtn = document.getElementById('revealBtn');
    const resetBtn = document.getElementById('resetBtn');
    const activeName = document.getElementById('activeName');
    const teamsContainer = document.getElementById('teamsContainer');

    function init(){
      remainingIdx = Array.from({length: bank.length}, (_,i)=>i);
      asked = [];
      current = null;
      currentTeam = 0;
      scores = [0,0,0,0];
      updateScoresUI();
      remainingEl.textContent = remainingIdx.length;
      bar.style.width = '0%';
      questionEl.textContent = 'Click Start Game to begin.';
      choicesEl.innerHTML = '';
      explainEl.style.display = 'none';
      nextBtn.disabled = true;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
      updateActiveUI();
    }

    function pick(){
      if (remainingIdx.length === 0) return null;
      const r = Math.floor(Math.random()*remainingIdx.length);
      const idx = remainingIdx.splice(r,1)[0];
      asked.push(idx);
      remainingEl.textContent = remainingIdx.length;
      const done = asked.length;
      bar.style.width = `${(done/bank.length)*100}%`;
      return idx;
    }

    function renderQuestion(idx){
      current = idx;
      const item = bank[idx];
      questionEl.textContent = `${asked.length}. (For ${getTeamName(currentTeam)}) ${item.q}`;
      choicesEl.innerHTML = '';
      explainEl.style.display = 'none';
      item.choices.forEach((c,i)=>{
        const div = document.createElement('div');
        div.className = 'choice';
        div.textContent = c;
        div.dataset.index = i;
        div.addEventListener('click', onChoice);
        choicesEl.appendChild(div);
      });
      nextBtn.disabled = true;
      correctBtn.disabled = false;
      wrongBtn.disabled = false;
      passBtn.disabled = false;
      revealBtn.disabled = false;
      updateActiveUI();
    }

    function onChoice(e){
      // treat as team answer attempt
      const choiceEl = e.currentTarget;
      if (choiceEl.classList.contains('disabled')) return;
      const picked = Number(choiceEl.dataset.index);
      const correct = bank[current].correct;
      // disable all
      Array.from(choicesEl.children).forEach(ch=>{
        ch.classList.add('disabled');
        if (Number(ch.dataset.index) === correct) ch.classList.add('correct');
        if (Number(ch.dataset.index) === picked && picked !== correct) ch.classList.add('wrong');
      });
      if (picked === correct){
        // award points to current team
        scores[currentTeam] += 10;
        explainEl.innerHTML = `<strong>Correct.</strong> ${bank[current].ex}`;
      } else {
        explainEl.innerHTML = `<strong>Incorrect.</strong> ${bank[current].ex}`;
      }
      explainEl.style.display = 'block';
      updateScoresUI();
      // after answering, allow next and rotate
      nextBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
    }

    function awardCorrect(){
      scores[currentTeam] += 10;
      explainEl.innerHTML = `<strong>Correct.</strong> ${bank[current].ex}`;
      explainEl.style.display = 'block';
      updateScoresUI();
      nextBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
    }

    function markWrong(){
      explainEl.innerHTML = `<strong>Incorrect.</strong> ${bank[current].ex}`;
      explainEl.style.display = 'block';
      nextBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
    }

    function passQuestion(){
      explainEl.innerHTML = `<strong>Passed.</strong> The answer was: ${bank[current].choices[bank[current].correct]}.`;
      explainEl.style.display = 'block';
      nextBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
    }

    function revealAnswer(){
      Array.from(choicesEl.children).forEach(ch=>{
        ch.classList.add('disabled');
        if (Number(ch.dataset.index) === bank[current].correct) ch.classList.add('correct');
      });
      explainEl.style.display = 'block';
      explainEl.textContent = `Answer: ${bank[current].choices[bank[current].correct]}. ${bank[current].ex}`;
      nextBtn.disabled = false;
      correctBtn.disabled = true;
      wrongBtn.disabled = true;
      passBtn.disabled = true;
      revealBtn.disabled = true;
    }

    function nextTurn(){
      // rotate team
      currentTeam = (currentTeam + 1) % 4;
      updateActiveUI();
      // pick next question
      const idx = pick();
      if (idx === null){
        questionEl.textContent = 'All questions completed.';
        choicesEl.innerHTML = '';
        explainEl.style.display = 'block';
        explainEl.textContent = `Game over. Final scores:\n${scores.map((s,i)=>`${getTeamName(i)}: ${s}`).join('\n')}`;
        nextBtn.disabled = true;
        correctBtn.disabled = true;
        wrongBtn.disabled = true;
        passBtn.disabled = true;
        revealBtn.disabled = true;
        return;
      }
      renderQuestion(idx);
    }

    function updateScoresUI(){
      for(let i=0;i<4;i++) document.getElementById('s'+i).textContent = scores[i];
    }

    function getTeamName(i){
      const input = document.getElementById('t'+i);
      return input ? input.value || `Team ${i+1}` : `Team ${i+1}`;
    }

    function updateActiveUI(){
      // highlight active team
      Array.from(teamsContainer.children).forEach(ch=>{
        const idx = Number(ch.dataset.index);
        if (idx === currentTeam) ch.classList.add('active'); else ch.classList.remove('active');
      });
      activeName.textContent = getTeamName(currentTeam);
    }

    // wire buttons
    startBtn.addEventListener('click', ()=>{
      init();
      // allow setting team names from top inputs
      for(let i=0;i<4;i++){
        const top = document.getElementById('team'+i+'Name');
        const inpt = document.getElementById('t'+i);
        if (top && inpt) inpt.value = top.value || inpt.value;
      }
      const idx = pick();
      if (idx!==null) renderQuestion(idx);
    });

    nextBtn.addEventListener('click', ()=>{
      nextTurn();
    });

    correctBtn.addEventListener('click', ()=>{ awardCorrect(); });
    wrongBtn.addEventListener('click', ()=>{ markWrong(); });
    passBtn.addEventListener('click', ()=>{ passQuestion(); });
    revealBtn.addEventListener('click', ()=>{ revealAnswer(); });

    resetBtn.addEventListener('click', ()=>{ init(); });

    // initialize on load
    init();
  </script>
</body>
</html>
